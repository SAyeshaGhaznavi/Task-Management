{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/task-management/my-app/src/app/dashboard/page.tsx"],"sourcesContent":["// 'use client';\r\n// import { useAuth } from '../../../context/authContext';\r\n\r\n// export default function DashboardHome() {\r\n//   const { user, handleLogout } = useAuth();\r\n\r\n//   return (\r\n//     <div className=\"p-8\">\r\n//       <h1 className=\"text-2xl mb-4\">Welcome, {user?.user_name}</h1>\r\n//     </div>\r\n//   );\r\n// }\r\n\r\n\r\n'use client';\r\n\r\nimport { useAuth } from '../../../context/authContext';\r\nimport { useRouter } from 'next/navigation';\r\nimport apiClient from '../lib/api'; \r\nimport { useEffect, useState } from 'react';\r\n\r\nexport default function DashboardHome() {\r\n  const { user, handleLogout, isAdmin, setIsAdmin, companies, setCompanies} = useAuth();\r\n  const router = useRouter();\r\n  const [error, setError] = useState('');\r\n  //const { user, isAdmin, setIsAdmin } = useAuth();\r\n  const userId = user?.user_id;\r\n\r\n    useEffect(() => {\r\n    const fetchCompanies = async () => {\r\n      try {\r\n        const data = await apiClient.get(`/company-members/${userId}`);\r\n        setCompanies(data);\r\n  \r\n        const detailedCompanyPromises = data.map((company: any) =>\r\n          apiClient.get(`/company-members/${company.company_id}/${userId}`)\r\n        );\r\n  \r\n        const detailedCompanyMemberships = await Promise.all(detailedCompanyPromises);\r\n  \r\n        const adminCompany = detailedCompanyMemberships.find(\r\n          (company: any) => company.user_role === 'ADMIN'\r\n        );\r\n  \r\n        if (adminCompany) {\r\n          setIsAdmin({ type: true, company: adminCompany.company_id });\r\n          console.log(\"Admin of company ID:\", adminCompany.company_id);\r\n        } else {\r\n          setIsAdmin({ type: false, company: -1 });\r\n          console.log(\"User is not admin of any company.\");\r\n        }\r\n      } catch (err) {\r\n        console.error(err);\r\n        setError('Failed to fetch companies');\r\n      }\r\n    };\r\n  \r\n    if (userId) {\r\n      fetchCompanies();\r\n    }\r\n  }, [userId, setCompanies, setIsAdmin]);\r\n\r\n  const logout = async () => {\r\n    await handleLogout();\r\n    router.push('/login');\r\n  };\r\n  \r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50 flex items-center justify-center px-4\">\r\n      <div className=\"bg-white p-8 rounded-xl shadow-lg max-w-md w-full\">\r\n        <div className=\"text-center\">\r\n          <h1 className=\"text-3xl font-bold text-blue-600 mb-2\">\r\n            Welcome, {user?.user_name} ðŸ‘‹\r\n          </h1>\r\n          <p className=\"text-gray-600 mb-6\">\r\n            Email: <span className=\"font-medium\">{user?.email}</span>\r\n          </p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"AAAA,gBAAgB;AAChB,0DAA0D;AAE1D,4CAA4C;AAC5C,8CAA8C;AAE9C,aAAa;AACb,4BAA4B;AAC5B,sEAAsE;AACtE,aAAa;AACb,OAAO;AACP,IAAI;;;;;AAKJ;AACA;AACA;AACA;;;AALA;;;;;AAOe,SAAS;;IACtB,MAAM,EAAE,IAAI,EAAE,YAAY,EAAE,OAAO,EAAE,UAAU,EAAE,SAAS,EAAE,YAAY,EAAC,GAAG,CAAA,GAAA,0HAAA,CAAA,UAAO,AAAD;IAClF,MAAM,SAAS,CAAA,GAAA,qIAAA,CAAA,YAAS,AAAD;IACvB,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IACnC,kDAAkD;IAClD,MAAM,SAAS,MAAM;IAEnB,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;mCAAE;YACV,MAAM;0DAAiB;oBACrB,IAAI;wBACF,MAAM,OAAO,MAAM,2HAAA,CAAA,UAAS,CAAC,GAAG,CAAC,CAAC,iBAAiB,EAAE,QAAQ;wBAC7D,aAAa;wBAEb,MAAM,0BAA0B,KAAK,GAAG;8FAAC,CAAC,UACxC,2HAAA,CAAA,UAAS,CAAC,GAAG,CAAC,CAAC,iBAAiB,EAAE,QAAQ,UAAU,CAAC,CAAC,EAAE,QAAQ;;wBAGlE,MAAM,6BAA6B,MAAM,QAAQ,GAAG,CAAC;wBAErD,MAAM,eAAe,2BAA2B,IAAI;mFAClD,CAAC,UAAiB,QAAQ,SAAS,KAAK;;wBAG1C,IAAI,cAAc;4BAChB,WAAW;gCAAE,MAAM;gCAAM,SAAS,aAAa,UAAU;4BAAC;4BAC1D,QAAQ,GAAG,CAAC,wBAAwB,aAAa,UAAU;wBAC7D,OAAO;4BACL,WAAW;gCAAE,MAAM;gCAAO,SAAS,CAAC;4BAAE;4BACtC,QAAQ,GAAG,CAAC;wBACd;oBACF,EAAE,OAAO,KAAK;wBACZ,QAAQ,KAAK,CAAC;wBACd,SAAS;oBACX;gBACF;;YAEA,IAAI,QAAQ;gBACV;YACF;QACF;kCAAG;QAAC;QAAQ;QAAc;KAAW;IAErC,MAAM,SAAS;QACb,MAAM;QACN,OAAO,IAAI,CAAC;IACd;IAGA,qBACE,6LAAC;QAAI,WAAU;kBACb,cAAA,6LAAC;YAAI,WAAU;sBACb,cAAA,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAG,WAAU;;4BAAwC;4BAC1C,MAAM;4BAAU;;;;;;;kCAE5B,6LAAC;wBAAE,WAAU;;4BAAqB;0CACzB,6LAAC;gCAAK,WAAU;0CAAe,MAAM;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAMxD;GA7DwB;;QACsD,0HAAA,CAAA,UAAO;QACpE,qIAAA,CAAA,YAAS;;;KAFF","debugId":null}}]
}